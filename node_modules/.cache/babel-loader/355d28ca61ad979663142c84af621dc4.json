{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nexport const getBooks = createAsyncThunk(\"book/getBooks\", async (_, thunkAPI) => {\n  const {\n    rejectWithValue\n  } = thunkAPI;\n\n  try {\n    const res = await fetch(\"http://localhost:3005/books\");\n    const data = await res.json();\n    return data;\n  } catch (error) {\n    return rejectWithValue(error.message);\n  }\n});\nexport const insertBook = createAsyncThunk(\"book/insertBook\", async (bookData, thunkAPI) => {\n  const {\n    rejectWithValue,\n    getState,\n    dispatch\n  } = thunkAPI;\n\n  try {\n    bookData.userName = getState().auth.name; //disptch\n    // dispatch(deleteBook({ id: 5 }));\n\n    const res = await fetch(\"http://localhost:3005/books\", {\n      method: \"POST\",\n      body: JSON.stringify(bookData),\n      headers: {\n        \"Content-type\": \"application/json; charset=UTF-8\"\n      }\n    }); //report\n\n    const data = await res.json(); // dispatch(logInsert({ name: 'insertBook', status: 'success' }));\n\n    return data;\n  } catch (error) {\n    // dispatch(logInsert({ name: 'insertBook', status: 'failed' }));\n    return rejectWithValue(error.message);\n  }\n});\nexport const deleteBook = createAsyncThunk(\"book/deleteBook\", async (item, thunkAPI) => {\n  const {\n    rejectWithValue\n  } = thunkAPI;\n\n  try {\n    await fetch(`http://localhost:3005/books/${item.id}`, {\n      method: \"DELETE\",\n      headers: {\n        \"Content-type\": \"application/json; charset=UTF-8\"\n      }\n    });\n    return item;\n  } catch (error) {\n    return rejectWithValue(error.message);\n  }\n});\nconst bookSlice = createSlice({\n  name: \"book\",\n  initialState: {\n    books: [],\n    isLoading: false,\n    error: null\n  },\n  //get book\n  extraReducers: {\n    [getBooks.pending]: (state, action) => {\n      state.error = null;\n      state.isLoading = true;\n    },\n    [getBooks.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.books = action.payload;\n    },\n    [getBooks.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.error = action.payload;\n    },\n    //insert book\n    [insertBook.pending]: (state, action) => {\n      state.isLoading = true;\n      state.error = null;\n    },\n    [insertBook.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.books.push(action.payload);\n    },\n    [insertBook.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.error = action.payload;\n    },\n    //delete book\n    [deleteBook.pending]: (state, action) => {\n      state.isLoading = true;\n      state.error = null;\n    },\n    [deleteBook.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.books = state.books.filter(el => el.id !== action.payload.id);\n    },\n    [deleteBook.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.error = action.payload;\n    }\n  }\n});\nexport default bookSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","getBooks","_","thunkAPI","rejectWithValue","res","fetch","data","json","error","message","insertBook","bookData","getState","dispatch","userName","auth","name","method","body","JSON","stringify","headers","deleteBook","item","id","bookSlice","initialState","books","isLoading","extraReducers","pending","state","action","fulfilled","payload","rejected","push","filter","el","reducer"],"sources":["/Users/basharsamir/Documents/Project/react7/book-store/src/store/bookSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\n\nexport const getBooks = createAsyncThunk(\n  \"book/getBooks\",\n  async (_, thunkAPI) => {\n    const { rejectWithValue } = thunkAPI;\n    try {\n      const res = await fetch(\"http://localhost:3005/books\");\n      const data = await res.json();\n      return data;\n    } catch (error) {\n      return rejectWithValue(error.message);\n    }\n  }\n);\nexport const insertBook = createAsyncThunk(\n  \"book/insertBook\",\n  async (bookData, thunkAPI) => {\n    const { rejectWithValue, getState, dispatch } = thunkAPI;\n    try {\n      bookData.userName = getState().auth.name;\n      //disptch\n      // dispatch(deleteBook({ id: 5 }));\n      const res = await fetch(\"http://localhost:3005/books\", {\n        method: \"POST\",\n        body: JSON.stringify(bookData),\n        headers: {\n          \"Content-type\": \"application/json; charset=UTF-8\",\n        },\n      });\n      //report\n      const data = await res.json();\n      // dispatch(logInsert({ name: 'insertBook', status: 'success' }));\n      return data;\n    } catch (error) {\n      // dispatch(logInsert({ name: 'insertBook', status: 'failed' }));\n      return rejectWithValue(error.message);\n    }\n  }\n);\nexport const deleteBook = createAsyncThunk(\n  \"book/deleteBook\",\n  async (item, thunkAPI) => {\n    const { rejectWithValue } = thunkAPI;\n    try {\n      await fetch(`http://localhost:3005/books/${item.id}`, {\n        method: \"DELETE\",\n        headers: {\n          \"Content-type\": \"application/json; charset=UTF-8\",\n        },\n      });\n\n      return item;\n    } catch (error) {\n      return rejectWithValue(error.message);\n    }\n  }\n);\n\nconst bookSlice = createSlice({\n  name: \"book\",\n  initialState: { books: [], isLoading: false, error: null },\n  //get book\n  extraReducers: {\n    [getBooks.pending]: (state, action) => {\n      state.error = null;\n      state.isLoading = true;\n    },\n    [getBooks.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.books = action.payload;\n    },\n    [getBooks.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.error = action.payload;\n    },\n    //insert book\n    [insertBook.pending]: (state, action) => {\n      state.isLoading = true;\n      state.error = null;\n    },\n    [insertBook.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.books.push(action.payload);\n    },\n    [insertBook.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.error = action.payload;\n    },\n\n    //delete book\n    [deleteBook.pending]: (state, action) => {\n      state.isLoading = true;\n      state.error = null;\n    },\n    [deleteBook.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.books = state.books.filter((el) => el.id !== action.payload.id);\n    },\n    [deleteBook.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.error = action.payload;\n    },\n  },\n});\n\nexport default bookSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}